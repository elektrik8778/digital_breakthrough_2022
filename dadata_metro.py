from dadata import Dadata
import csv
from geopy.distance import geodesic

token = "e7a069e82e59b21e36a44924ebfceeb16fc50923"
secret = "b892f8e65a04c3d363be0db08aa6939fdf37b8aa"

zero_point = (55.75222, 37.61556)

staitions = ['Лефортово',
             'Войковская',
             'Аэропорт',
             'Косино',
             'Котельники',
             'Сокол',
             'Новогиреево',
             'Кунцевская',
             'Проспект Вернадского',
             'Динамо',
             'Черкизовская',
             'Отрадное',
             'Крылатское',
             'Мнёвники',
             'Хорошёвская',
             'Селигерская',
             'Павелецкая',
             'Первомайская',
             'Орехово',
             'Тургеневская',
             'Выставочная',
             'Кропоткинская',
             'Площадь Ильича',
             'Мякинино',
             'Лухмановская',
             'Свиблово',
             'Бутырская',
             'Петровско-Разумовская',
             'Владыкино',
             'Комсомольская',
             'Таганская',
             'Проспект Мира',
             'Шипиловская',
             'Третьяковская',
             'Выхино',
             'Каширская',
             'Савёловская',
             'Семёновская',
             'Рязанский проспект',
             'Чертановская',
             'Печатники',
             'Балтийская',
             'Преображенская площадь',
             'Севастопольская',
             'Тимирязевская',
             'Перово',
             'Панфиловская',
             'Борисово',
             'ВДНХ',
             'Новые Черёмушки',
             'Партизанская',
             'Ботанический сад',
             'Лубянка',
             'Спартак',
             'Солнцево',
             'Аннино',
             'Нижегородская',
             'Бульвар Рокоссовского',
             'Смоленская',
             'Новокосино',
             'Локомотив',
             'Белорусская',
             'Планерная',
             'Рассказовка',
             'Красногвардейская',
             'Верхние Котлы',
             'Царицыно',
             'Щёлковская',
             'Молодёжная',
             'Шоссе Энтузиастов',
             'Кузьминки',
             'Тушинская',
             'Медведково',
             'Текстильщики',
             'Водный стадион',
             'Нагатинская',
             'Славянский бульвар',
             'Электрозаводская',
             'Говорово',
             'Бульвар Дмитрия Донского',
             'Краснопресненская',
             'Красносельская',
             'Стахановская',
             'Римская',
             'Тульская',
             'Сухаревская',
             'Бабушкинская',
             'Некрасовка',
             'Академическая',
             'Каховская',
             'Раменки',
             'Зюзино',
             'Автозаводская',
             'Баррикадная',
             'Марьино',
             'Терехово',
             'Строгино',
             'Фили',
             'Лермонтовский проспект',
             'Новоясеневская',
             'Дубровка',
             'Юго-Западная',
             'Кожуховская',
             'Нагорная',
             'Нахимовский проспект',
             'Угрешская',
             'Сходненская',
             'Коммунарка',
             'Бульвар Адмирала Ушакова',
             'Митино',
             'Мичуринский проспект',
             'Киевская',
             'Пражская',
             'Менделеевская',
             'Кутузовская',
             'Братиславская',
             'Спортивная',
             'Озёрная',
             'Волоколамская',
             'Профсоюзная',
             'Южная',
             'Авиамоторная',
             'Улица Горчакова',
             'Боровское шоссе',
             'Верхние Лихоборы',
             'Шелепиха',
             'Люблино',
             'Университет',
             'Марксистская',
             'Улица Академика Янгеля',
             'Ростокино',
             'ЦСКА',
             'Октябрьское поле',
             'Домодедовская',
             'Зябликово',
             'Трубная',
             'Марьина Роща',
             'Китай-город',
             'Волжская',
             'Новопеределкино',
             'Тёплый Стан',
             'Речной вокзал',
             'Маяковская',
             'Курская',
             'Новохохловская',
             'Стрешнево',
             'Фрунзенская',
             'Крымская',
             'Жулебино',
             'Калужская',
             'Кузнецкий мост',
             'Чкаловская',
             'Бибирево',
             'Пушкинская',
             'Деловой центр',
             'Окружная',
             'Пятницкое шоссе',
             'Багратионовская',
             'Бауманская',
             'Сокольники',
             'Щукинская',
             'Охотный ряд',
             'Беломорская',
             'Дмитровская',
             'Серпуховская',
             'Ясенево',
             'Новокузнецкая',
             'Румянцево',
             'Алексеевская',
             'Народное Ополчение',
             'Измайлово',
             'Измайловская',
             'Саларьево',
             'Достоевская',
             'Улица Дмитриевского',
             'Алма-Атинская',
             'Воробьёвы горы',
             'Хорошёво',
             'Давыдково',
             'Беляево',
             'Кантемировская',
             'Ольховая',
             'Студенческая',
             'Полежаевская',
             'Арбатская',
             'Битцевский парк',
             'Коломенская',
             'Парк Победы',
             'Чистые пруды',
             'Ховрино',
             'Октябрьская',
             'Рижская',
             'Юго-Восточная',
             'Чеховская',
             'Красные Ворота',
             'Минская',
             'Пионерская',
             'Алтуфьево',
             'Фонвизинская',
             'Волгоградский проспект',
             'Коптево',
             'Пролетарская',
             'Коньково',
             'Беговая',
             'Новослободская',
             'Улица Скобелевская',
             'Шаболовская',
             'Лихоборы',
             'Филатов луг',
             'Ленинский проспект',
             'Бунинская аллея',
             'Воронцовская',
             'Окская',
             'Прокшино',
             'Филёвский парк',
             'Соколиная гора',
             'Новаторская',
             'Добрынинская',
             'Площадь Гагарина',
             'Андроновка',
             'Александровский сад',
             'Улица 1905 года',
             'Тропарёво',
             'Аминьевская',
             'Площадь Революции',
             'Цветной бульвар',
             'Лесопарковая',
             'Петровский парк',
             'Полянка',
             'Ломоносовский проспект',
             'Технопарк',
             'Парк культуры',
             'Международная',
             'Зорге',
             'Лужники',
             'Сретенский бульвар',
             'Белокаменная',
             'Боровицкая',
             'Крестьянская застава',
             'ЗИЛ',
             'Выставочный центр',
             'Улица Милашенкова',
             'Улица Академика Королёва',
             'Улица Эйзенштейна',
             'Телецентр']
data_st = {}

with Dadata(token, secret) as dadata:
    with open('data/stations.csv', 'w', newline='', encoding='utf-8') as csvfile:
        staitionwriter = csv.writer(csvfile,
                                    delimiter=',',
                                    quotechar='|',
                                    quoting=csv.QUOTE_MINIMAL)
        staitionwriter.writerow(['station_nm', 'line_id', 'geo_lat', 'geo_lon', 'st_dist_from_center'])

        for station in staitions:
            
            result = dadata.suggest("metro", station)
            for i in result:

                st_nm = station
                st_line_id = i['data']['line_id']
                if st_line_id=='8А':
                    st_line_id = 81
                elif st_line_id == 'М':
                    st_line_id = 13
                st_line_nm = i['data']['line_name']
                st_geo_lat = i['data']['geo_lat']
                st_geo_lon = i['data']['geo_lon']
                st_dist_from_center = geodesic(zero_point, (st_geo_lat, st_geo_lon)).km

                
                print(st_nm,
                      st_line_id,
                      st_line_nm,
                      st_geo_lat,
                      st_geo_lon,
                      st_dist_from_center,
                      )
    
                staitionwriter.writerow([st_nm,
                                         st_line_id,
                                         st_geo_lat,
                                         st_geo_lon,
                                         st_dist_from_center])
            
            

  
    
    


